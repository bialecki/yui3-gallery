<<<<<<< HEAD
<<<<<<< HEAD
YUI.add("gallery-accordion",function(A){(function(){function M(v){M.superclass.constructor.apply(this,arguments);}var u=A.Lang,V=A.Node,Z=A.Anim,H=A.Easing,N="accordion",X=A.WidgetStdMod,s=document.compatMode=="BackCompat",T=s&&A.UA.ie>0,U=T?1:0,I=A.ClassNameManager.getClassName,W="yui-accordion-item",f=I(N,"proxyel","visible"),h=I(N,"graggroup"),b="beforeItemAdd",e="itemAdded",D="beforeItemRemove",i="itemRemoved",C="beforeItemResized",p="itemResized",d="beforeItemExpand",g="beforeItemCollapse",J="itemExpanded",m="itemCollapsed",j="beforeItemReorder",R="beforeEndItemReorder",S="itemReordered",k="default",O="animation",P="alwaysVisible",E="expanded",c="collapseOthersOnExpand",Y="items",t="contentHeight",B="iconClose",F="iconAlwaysVisible",G="stretch",r="px",a="contentBox",n="boundingBox",l="rendered",o="bodyContent",Q="children",K="parentNode",q="node",L="data";M.NAME=N;M.ATTRS={itemChosen:{value:"click",validator:u.isString},items:{value:[],readOnly:true,validator:u.isArray},resizeEvent:{value:k,validator:function(v){if(v===k){return true;}else{if(u.isObject(v)){if(u.isValue(v.sourceObject)&&u.isValue(v.resizeEvent)){return true;}}}return false;}},useAnimation:{value:true,validator:u.isBoolean},animation:{value:{duration:1,easing:H.easeOutStrong},validator:function(v){return u.isObject(v)&&u.isNumber(v.duration)&&u.isFunction(v.easing);}},reorderItems:{value:false,validator:function(v){return u.isBoolean(v)&&!u.isUndefined(A.DD);}},collapseOthersOnExpand:{value:true,validator:u.isBoolean}};A.extend(M,A.Widget,{initializer:function(v){this._initEvents();this.after("render",A.bind(this._afterRender,this));},destructor:function(){var v,y,w,x;v=this.get(Y);x=v.length;for(w=x-1;w>=0;w--){y=v[w];v.splice(w,1);this._removeItemHandles(y);y.destroy();}},_initEvents:function(){this.publish(b);this.publish(e);this.publish(D);this.publish(i);this.publish(C);this.publish(p);this.publish(d);this.publish(g);this.publish(J);this.publish(m);this.publish(j);this.publish(R);this.publish(S);},_forCollapsing:{},_forExpanding:{},_animations:{},_itemsHandles:{},_removeItemHandles:function(x){var w,v;w=this._itemsHandles[x];for(v in w){if(w.hasOwnProperty(v)){v=w[v];v.detach();}}delete this._itemsHandles[x];},_getNodeOffsetHeight:function(x){var v,w;if(x instanceof V){if(x.hasMethod("getBoundingClientRect")){w=x.invoke("getBoundingClientRect");if(w){v=w.bottom-w.top;return v;}}else{v=x.get("offsetHeight");return A.Lang.isValue(v)?v:0;}}else{if(x){v=x.offsetHeight;return A.Lang.isValue(v)?v:0;}}return 0;},_setItemProperties:function(x,z,w){var v,y;v=x.get(P);y=x.get(E);if(z!=y){x.set(E,z,{internalCall:true});}if(w!==v){x.set(P,w,{internalCall:true});}},_setItemUI:function(w,x,v){w.markAsExpanded(x);w.markAsAlwaysVisible(v);},_afterRender:function(w){var v;v=this.get("resizeEvent");this._setUpResizing(v);this.after("resizeEventChange",A.bind(this._afterResizeEventChange,this));},_afterResizeEventChange:function(v){this._setUpResizing(v.newVal);},_onItemChosen:function(AA,AB,v){var z,x,y,w;z={};w=this.get(c);x=AA.get(P);y=AA.get(E);if(v){this.removeItem(AA);return;}else{if(AB){if(y){x=!x;y=x?true:y;this._setItemProperties(AA,y,x);this._setItemUI(AA,y,x);return;}else{this._forExpanding[AA]={"item":AA,alwaysVisible:true};if(w){z[AA]={"item":AA};this._storeItemsForCollapsing(z);}}}else{if(y){this._forCollapsing[AA]={"item":AA};}else{this._forExpanding[AA]={"item":AA,"alwaysVisible":x};if(w){z[AA]={"item":AA};this._storeItemsForCollapsing(z);}}}}this._processItems();},_adjustStretchItems:function(){var v=this.get(Y),w;w=this._getHeightPerStretchItem();A.Array.each(v,function(AB,AA,z){var x,AD,AC,AE,y;AE=AB.get(t);y=AB.get(E);if(AE.method===G&&y){AC=this._animations[AB];if(AC){AC.stop();}x=AB.getStdModNode(X.BODY);AD=this._getNodeOffsetHeight(x);if(w<AD){this._processCollapsing(AB,w);}else{if(w>AD){this._processExpanding(AB,w);}}}},this);return w;},_getHeightPerStretchItem:function(){var v,x,w=0;x=this.get(Y);v=this.get(n).get("clientHeight");A.Array.each(x,function(AC,AB,AA){var AD,z,AF,AE,y;AF=AC.getStdModNode(X.HEADER);AE=AC.get(t);y=this._getNodeOffsetHeight(AF);v-=y;AD=!AC.get(E);if(AD){v-=U;return;}if(AE.method===G){w++;}else{z=this._getItemContentHeight(AC);v-=z;}},this);if(w>0){v/=w;}if(v<0){v=0;}return v;},_getItemContentHeight:function(x){var z,w=0,v,y;z=x.get(t);if(z.method==="auto"){v=x.getStdModNode(X.BODY);y=v.get(Q).item(0);w=y?this._getNodeOffsetHeight(y):0;}else{if(z.method==="fixed"){w=z.height;}else{w=this._getHeightPerStretchItem();}}return w;},_storeItemsForCollapsing:function(w){var v;w=w||{};v=this.get(Y);A.Array.each(v,function(AB,AA,z){var y,x;y=AB.get(E);x=AB.get(P);if(y&&!x&&!w[AB]){this._forCollapsing[AB]={"item":AB};}},this);},_expandItem:function(x,v){var w=x.get(P);this._processExpanding(x,v);this._setItemUI(x,true,w);},_processExpanding:function(AC,AB,v){var w,x,z,AD=false,AA,y;y=AC.getStdModNode(X.BODY);this.fire(C,{"item":AC});if(y.get("clientHeight")<=0){AD=true;this.fire(d,{"item":AC});}if(!v&&this.get("useAnimation")){z=AC.get(O)||{};w=new Z({node:y,to:{"height":AB}});w.on("end",A.bind(this._onExpandComplete,this,AC,AD));AA=this.get(O);w.set("duration",z.duration||AA.duration);w.set("easing",z.easing||AA.easing);x=this._animations[AC];if(x){x.stop();}AC.markAsExpanding(true);this._animations[AC]=w;w.run();}else{y.setStyle("height",AB+r);this.fire(p,{"item":AC});if(AD){this.fire(J,{"item":AC});}}},_onExpandComplete:function(v,w){delete this._animations[v];v.markAsExpanding(false);this.fire(p,{"item":v});if(w){this.fire(J,{"item":v});}},_collapseItem:function(v){this._processCollapsing(v,U);this._setItemUI(v,false,false);},_processCollapsing:function(AC,AB,v){var w,x,z,AA,y,AD=(AB===U);y=AC.getStdModNode(X.BODY);this.fire(C,{"item":AC});if(AD){this.fire(g,{"item":AC});}if(!v&&this.get("useAnimation")){z=AC.get(O)||{};w=new Z({node:y,to:{"height":AB}});w.on("end",A.bind(this._onCollapseComplete,this,AC,AD));AA=this.get(O);w.set("duration",z.duration||AA.duration);w.set("easing",z.easing||AA.easing);
x=this._animations[AC];if(x){x.stop();}AC.markAsCollapsing(true);this._animations[AC]=w;w.run();}else{y.setStyle("height",AB+r);this.fire(p,{"item":AC});if(AD){this.fire(m,{"item":AC});}}},_onCollapseComplete:function(v,w){delete this._animations[v];v.markAsCollapsing(false);this.fire(p,{item:v});if(w){this.fire(m,{"item":v});}},_initItemDragDrop:function(w){var AA,v,z,x,y;AA=w.getStdModNode(X.HEADER);if(AA.dd){return;}z=this.get(n);x=w.get(n);v=new A.DD.Drag({node:AA,groups:[h]}).plug(A.Plugin.DDProxy,{moveOnEnd:false}).plug(A.Plugin.DDConstrained,{constrain2node:z});y=new A.DD.Drop({node:x,groups:[h]});v.on("drag:start",A.bind(this._onDragStart,this,v));v.on("drag:end",A.bind(this._onDragEnd,this,v));v.after("drag:end",A.bind(this._afterDragEnd,this,v));v.on("drag:drophit",A.bind(this._onDropHit,this,v));},_onDragStart:function(v,y){var x,w;w=this.getItem(v.get(q).get(K));x=v.get("dragNode");x.addClass(f);x.set("innerHTML",w.get("label"));return this.fire(j,{"item":w});},_onDragEnd:function(v,y){var x,w;x=v.get("dragNode");x.removeClass(f);x.set("innerHTML","");w=this.getItem(v.get(q).get(K));return this.fire(R,{"item":w});},_afterDragEnd:function(v,y){var w,x;x=v.get(L);if(x.drophit){w=this.getItem(v.get(q).get(K));v.set(L,{drophit:false});return this.fire(S,{"item":w});}return true;},_onDropHit:function(AE,AA){var z,AD,w,AC,y,v,AB,x,AF;AF=this.getItem(AE.get(q).get(K));x=this.getItem(AA.drop.get(q));if(x===AF){return false;}z=this.getItemIndex(AF);AD=this.getItemIndex(x);w=x.get(n);AC=AF.get(n);y=this.get(a);v=false;AB=this.get(Y);if(AD<z){v=true;}y.removeChild(AC);if(v){y.insertBefore(AC,w);AB.splice(z,1);AB.splice(AD,0,AF);}else{y.insertBefore(AC,w.next(W));AB.splice(AD+1,0,AF);AB.splice(z,1);}AE.set(L,{drophit:true});return true;},_processItems:function(){var x,w,y,AA,v,AB,z;x=this._forCollapsing;w=this._forExpanding;this._setItemsProperties();for(z in x){if(x.hasOwnProperty(z)){y=x[z];this._collapseItem(y.item);}}AA=this._adjustStretchItems();for(z in w){if(w.hasOwnProperty(z)){y=w[z];z=y.item;v=AA;AB=z.get(t);if(AB.method!==G){v=this._getItemContentHeight(z);}this._expandItem(z,v);}}this._forCollapsing={};this._forExpanding={};},_setItemsProperties:function(){var x,w,v;x=this._forCollapsing;w=this._forExpanding;for(v in x){if(x.hasOwnProperty(v)){v=x[v];this._setItemProperties(v.item,false,false);}}for(v in w){if(w.hasOwnProperty(v)){v=w[v];this._setItemProperties(v.item,true,v.alwaysVisible);}}},_afterItemExpand:function(z){var x,y,w,v;if(z.internalCall){return;}x=z.newVal;y=z.currentTarget;w=y.get(P);v=this.get(c);if(x){this._forExpanding[y]={"item":y,"alwaysVisible":w};if(v){this._storeItemsForCollapsing();}}else{this._forCollapsing[y]={"item":y};}this._processItems();},_afterItemAlwaysVisible:function(y){var x,v,w;if(y.internalCall){return;}v=y.newVal;x=y.currentTarget;w=x.get(E);if(v){if(w){this._setItemProperties(x,true,true);this._setItemUI(x,true,true);return;}else{this._forExpanding[x]={"item":x,"alwaysVisible":true};this._storeItemsForCollapsing();}}else{if(w){this._setItemUI(x,true,false);return;}else{return;}}this._processItems();},_afterContentHeight:function(AA){var y,w,v,z,x;y=AA.currentTarget;this._adjustStretchItems();if(AA.newVal.method!==G){x=y.get(E);w=this._getItemContentHeight(y);v=y.getStdModNode(X.BODY);z=this._getNodeOffsetHeight(v);if(w<z){this._processCollapsing(y,w,!x);}else{if(w>z){this._processExpanding(y,w,!x);}}}},_afterContentUpdate:function(AB){var y,w,v,AA,x,AC,z;y=AB.currentTarget;AC=y.get("contentHeight").method==="auto";x=y.get(E);if(AC&&x&&AB.src!==A.Widget.UI_SRC){A.later(0,this,function(){w=this._getItemContentHeight(y);v=y.getStdModNode(X.BODY);AA=this._getNodeOffsetHeight(v);if(w!==AA){z=this._animations[y];if(z){z.stop();}this._adjustStretchItems();if(w<AA){this._processCollapsing(y,w,!x);}else{if(w>AA){this._processExpanding(y,w,!x);}}}});}},_setUpResizing:function(v){if(this._resizeEventHandle){this._resizeEventHandle.detach();}if(v===k){this._resizeEventHandle=A.on("windowresize",A.bind(this._adjustStretchItems,this));}else{this._resizeEventHandle=v.sourceObject.on(v.resizeEvent,A.bind(this._adjustStretchItems,this));}},renderUI:function(){var v,w;v=this.get(a);w=v.queryAll("> div."+W);w.each(function(AA,x,z){var y;if(!this.getItem(AA)){y=new A.AccordionItem({contentBox:AA});this.addItem(y);}},this);},bindUI:function(){var v,w;v=this.get(a);w=this.get("itemChosen");v.delegate(w,A.bind(this._onItemChosenEvent,this),"div.yui-widget-hd");},_onItemChosenEvent:function(AA){var AC,AB,x,y,w,z,v;AC=AA.currentTarget;AB=AC.get(K);x=this.getItem(AB);y=x.get(F);w=x.get(B);z=(y===AA.target);v=(w===AA.target);this._onItemChosen(x,z,v);},addItem:function(AI,y){var AB,AG,AF,v,AD,AE,AH,AA,AC,z,x,w;AC=this.fire(b,{"item":AI});if(!AC){return false;}AD=this.get(Y);AE=this.get(a);AA=AI.get(a);w=AI.get(n);if(!AA.inDoc()){if(y){v=this.getItemIndex(y);if(v<0){return false;}AD.splice(v,0,AI);if(AI.get(l)){AE.insertBefore(w,y.get(n));}else{AE.insertBefore(AA,y.get(n));}}else{AD.push(AI);if(AI.get(l)){AE.insertBefore(w,null);}else{AE.insertBefore(AA,null);}}}else{z=this.get(a);x=z.get(Q);AC=x.some(function(AL,AK,AJ){if(AL===AA){AD.splice(AK,0,AI);return true;}else{return false;}},this);if(!AC){return false;}}AF=AI.get(o);if(!AF){AI.set(o,"&nbsp;");}if(!AI.get(l)){AI.render();}AB=AI.get(E);AG=AI.get(P);AB=AB||AG;if(AB){this._forExpanding[AI]={"item":AI,"alwaysVisible":AG};}else{this._forCollapsing[AI]={"item":AI};}this._processItems();if(this.get("reorderItems")){this._initItemDragDrop(AI);}AH=this._itemsHandles[AI];if(!AH){AH={};}AH={"expandedChange":AI.after("expandedChange",A.bind(this._afterItemExpand,this)),"alwaysVisibleChange":AI.after("alwaysVisibleChange",A.bind(this._afterItemAlwaysVisible,this)),"contentHeightChange":AI.after("contentHeightChange",A.bind(this._afterContentHeight,this)),"contentUpdate":AI.after("contentUpdate",A.bind(this._afterContentUpdate,this))};this._itemsHandles[AI]=AH;this.fire(e,{"item":AI});return true;},removeItem:function(w){var v,z,y=null,x;
v=this.get(Y);if(u.isNumber(w)){x=w;}else{if(w instanceof A.AccordionItem){x=this.getItemIndex(w);}else{return null;}}if(x>=0){this.fire(D,{item:w});y=v.splice(x,1)[0];this._removeItemHandles(y);z=y.get(n);z.remove();this._adjustStretchItems();this.fire(i,{item:w});}return y;},getItem:function(x){var v=this.get(Y),w=null;if(u.isNumber(x)){w=v[x];return(w instanceof A.AccordionItem)?w:null;}else{if(x instanceof V){A.Array.some(v,function(AC,AB,z){var y,AA;y=AC.get(a);AA=AC.get(n);if(y===x){w=AC;return true;}else{if(AA===x){w=AC;return true;}else{return false;}}},this);}}return w;},getItemIndex:function(x){var w=-1,v;if(x instanceof A.AccordionItem){v=this.get(Y);A.Array.some(v,function(AA,z,y){if(AA===x){w=z;return true;}else{return false;}},this);}return w;}});A.Accordion=M;}());(function(){function c(AA){c.superclass.constructor.apply(this,arguments);}var y=A.Lang,S=A.Base,e=A.Node,Q=A.JSON,f=A.WidgetStdMod,h="accordion-item",O=A.ClassNameManager.getClassName,D=O(h,"iconexpanded","expanding"),w=O(h,"iconexpanded","collapsing"),P=O(h,"icon"),L=O(h,"label"),s=O(h,"iconalwaysvisible"),j=O(h,"icons"),q=O(h,"iconexpanded"),n=O(h,"iconclose"),R=O(h,"iconclose","hidden"),U=O(h,"iconexpanded","on"),M=O(h,"iconexpanded","off"),E=O(h,"iconalwaysvisible","on"),o=O(h,"iconalwaysvisible","off"),a=O(h,"expanded"),X=O(h,"closable"),l=O(h,"alwaysvisible"),m=O(h,"contentheight"),p="title",C="strings",g="contentBox",u="rendered",I="className",i="auto",K="stretch",Y="fixed",V=".yui-widget-hd",b=".",r=".yui-widget-hd "+b,v="innerHTML",x="iconsContainer",k="icon",T="nodeLabel",H="iconAlwaysVisible",d="iconExpanded",B="iconClose",t="href",W="#",G="yuiConfig",F="headerContent",J=/^(?:true|yes|1)$/,N=/^auto\s*/,z=/^stretch\s*/,Z=/^fixed-\d+/;c.NAME=h;c.ATTRS={icon:{value:null,validator:function(AA){return this._validateIcon(AA);},setter:function(AA){return this._setIcon(AA);}},label:{value:"&#160;",validator:y.isString},nodeLabel:{value:null,validator:function(AA){return this._validateNodeLabel(AA);},setter:function(AA){return this._setNodeLabel(AA);}},iconsContainer:{value:null,validator:function(AA){return this._validateIconsContainer(AA);},setter:function(AA){return this._setIconsContainer(AA);}},iconExpanded:{value:null,validator:function(AA){return this._validateIconExpanded(AA);},setter:function(AA){return this._setIconExpanded(AA);}},iconAlwaysVisible:{value:null,validator:function(AA){return this._validateIconAlwaysVisible(AA);},setter:function(AA){return this._setIconAlwaysVisible(AA);}},iconClose:{value:null,validator:function(AA){return this._validateIconClose(AA);},setter:function(AA){return this._setIconClose(AA);}},expanded:{value:false,validator:y.isBoolean},contentHeight:{value:{method:i},validator:function(AA){if(y.isObject(AA)){if(AA.method===i){return true;}else{if(AA.method===K){return true;}else{if(AA.method===Y&&y.isNumber(AA.height)&&AA.height>=0){return true;}}}}return false;}},alwaysVisible:{value:false,validator:y.isBoolean},animation:{value:{},validator:y.isObject},strings:{value:{title_always_visible_off:"Click to set always visible on",title_always_visible_on:"Click to set always visible off",title_iconexpanded_off:"Click to expand",title_iconexpanded_on:"Click to collapse",title_iconclose:"Click to close"}},closable:{value:false,validator:y.isBoolean}};c.HTML_PARSER={icon:r+P,label:function(AA){var AD,AE,AC,AB;AC=this._getConfigDOMAttribute(AA);if(AC&&y.isValue(AC.label)){return AC.label;}AB=AA.getAttribute("data-label");if(AB){return AB;}AE=r+L;AD=AA.query(AE);return(AD)?AD.get(v):null;},nodeLabel:r+L,iconsContainer:r+j,iconAlwaysVisible:r+s,iconExpanded:r+q,iconClose:r+n,expanded:function(AA){var AC,AB;AC=this._getConfigDOMAttribute(AA);if(AC&&y.isBoolean(AC.expanded)){return AC.expanded;}AB=AA.getAttribute("data-expanded");if(AB){return J.test(AB);}return AA.hasClass(a);},alwaysVisible:function(AB){var AC,AA;AC=this._getConfigDOMAttribute(AB);if(AC&&y.isBoolean(AC.alwaysVisible)){AA=AC.alwaysVisible;}else{AA=AB.getAttribute("data-alwaysvisible");if(AA){AA=J.test(AA);}else{AA=AB.hasClass(l);}}if(AA){this.set("expanded",true,{internalCall:true});}return AA;},closable:function(AA){var AC,AB;AC=this._getConfigDOMAttribute(AA);if(AC&&y.isBoolean(AC.closable)){return AC.closable;}AB=AA.getAttribute("data-closable");if(AB){return J.test(AB);}return AA.hasClass(X);},contentHeight:function(AB){var AF,AG,AA=0,AC,AE,AD;AE=this._getConfigDOMAttribute(AB);if(AE&&AE.contentHeight){return AE.contentHeight;}AD=AB.getAttribute("data-contentheight");if(N.test(AD)){return{method:i};}else{if(z.test(AD)){return{method:K};}else{if(Z.test(AD)){AA=this._extractFixedMethodValue(AD);return{method:Y,height:AA};}}}AG=AB.get(I);AF=m+"-";AC=AG.indexOf(AF,0);if(AC>=0){AC+=AF.length;AG=AG.substring(AC);if(N.test(AG)){return{method:i};}else{if(z.test(AG)){return{method:K};}else{if(Z.test(AG)){AA=this._extractFixedMethodValue(AG);return{method:Y,height:AA};}}}}return null;}};c.TEMPLATES={icon:'<a class="'+P+'"></a>',label:'<a href="#" class="'+L+'"></a>',iconsContainer:'<div class="'+j+'"></div>',iconExpanded:['<a href="#" class="',q," ",M,'"></a>'].join(""),iconAlwaysVisible:['<a href="#" class="',s," ",o,'"></a>'].join(""),iconClose:['<a href="#" class="',n," ",R,'"></a>'].join("")};A.extend(c,A.Widget,{_createHeader:function(){var AI,AG,AH,AE,AF,AD,AB,AA,AC;AF=this.get(k);AD=this.get(T);AB=this.get(d);AA=this.get(H);AC=this.get(B);AE=this.get(x);AH=this.get(C);AI=this.get("closable");AG=c.TEMPLATES;if(!AF){AF=e.create(AG.icon);this.set(k,AF);}if(!AD){AD=e.create(AG.label);this.set(T,AD);}else{if(!AD.hasAttribute(t)){AD.setAttribute(t,W);}}AD.setContent(this.get("label"));if(!AE){AE=e.create(AG.iconsContainer);this.set(x,AE);}if(!AA){AA=e.create(AG.iconAlwaysVisible);AA.setAttribute(p,AH.title_always_visible_off);this.set(H,AA);}else{if(!AA.hasAttribute(t)){AA.setAttribute(t,W);}}if(!AB){AB=e.create(AG.iconExpanded);AB.setAttribute(p,AH.title_iconexpanded_off);this.set(d,AB);}else{if(!AB.hasAttribute(t)){AB.setAttribute(t,W);
}}if(!AC){AC=e.create(AG.iconClose);AC.setAttribute(p,AH.title_iconclose);this.set(B,AC);}else{if(!AC.hasAttribute(t)){AC.setAttribute(t,W);}}if(AI){AC.removeClass(R);}else{AC.addClass(R);}this._addHeaderComponents();},_addHeaderComponents:function(){var AG,AB,AF,AC,AE,AD,AA;AB=this.get(k);AF=this.get(T);AE=this.get(d);AD=this.get(H);AA=this.get(B);AC=this.get(x);AG=this.get(F);if(!AG){AG=new e(document.createDocumentFragment());AG.appendChild(AB);AG.appendChild(AF);AG.appendChild(AC);AC.appendChild(AD);AC.appendChild(AE);AC.appendChild(AA);this.setStdModContent(f.HEADER,AG,f.REPLACE);}else{if(!AG.contains(AB)){if(AG.contains(AF)){AG.insertBefore(AB,AF);}else{AG.appendChild(AB);}}if(!AG.contains(AF)){AG.appendChild(AF);}if(!AG.contains(AC)){AG.appendChild(AC);}if(!AC.contains(AD)){AC.appendChild(AD);}if(!AC.contains(AE)){AC.appendChild(AE);}if(!AC.contains(AA)){AC.appendChild(AA);}}},_labelChanged:function(AB){var AA;if(this.get(u)){AA=this.get(T);AA.set(v,AB.newVal);}},_closableChanged:function(AB){var AA;if(this.get(u)){AA=this.get(B);if(AB.newVal){AA.removeClass(R);}else{AA.addClass(R);}}},initializer:function(AA){this.after("labelChange",A.bind(this._labelChanged,this));this.after("closableChange",A.bind(this._closableChanged,this));},destructor:function(){},renderUI:function(){this._createHeader();},bindUI:function(){var AA;AA=this.get(g);AA.delegate("click",A.bind(this._onLinkClick,this),V+" a");},_onLinkClick:function(AA){AA.preventDefault();},markAsAlwaysVisible:function(AB){var AC,AA;AC=this.get(H);AA=this.get(C);if(AB){if(!AC.hasClass(E)){AC.replaceClass(o,E);AC.set(p,AA.title_always_visible_on);return true;}}else{if(AC.hasClass(E)){AC.replaceClass(E,o);AC.set(p,AA.title_always_visible_off);return true;}}return false;},markAsExpanded:function(AB){var AA,AC;AC=this.get(d);AA=this.get(C);if(AB){if(!AC.hasClass(U)){AC.replaceClass(M,U);AC.set(p,AA.title_iconexpanded_on);return true;}}else{if(AC.hasClass(U)){AC.replaceClass(U,M);AC.set(p,AA.title_iconexpanded_off);return true;}}return false;},markAsExpanding:function(AB){var AA=this.get(d);if(AB){if(!AA.hasClass(D)){AA.addClass(D);return true;}}else{if(AA.hasClass(D)){AA.removeClass(D);return true;}}return false;},markAsCollapsing:function(AA){var AB=this.get(d);if(AA){if(!AB.hasClass(w)){AB.addClass(w);return true;}}else{if(AB.hasClass(w)){AB.removeClass(w);return true;}}return false;},resize:function(){this.fire("contentUpdate");},_getConfigDOMAttribute:function(AA){if(!this._parsedCfg){this._parsedCfg=AA.getAttribute(G);if(this._parsedCfg){this._parsedCfg=Q.parse(this._parsedCfg);}}return this._parsedCfg;},_extractFixedMethodValue:function(AE){var AB,AD,AC,AA=null;for(AB=6,AD=AE.length;AB<AD;AB++){AC=AE.charAt(AB);AC=parseInt(AC,10);if(y.isNumber(AC)){AA=(AA*10)+AC;}else{break;}}return AA;},_validateIcon:function(AA){return !this.get(u)||AA;},_validateNodeLabel:function(AA){return !this.get(u)||AA;},_validateIconsContainer:function(AA){return !this.get(u)||AA;},_validateIconExpanded:function(AA){return !this.get(u)||AA;},_validateIconAlwaysVisible:function(AA){return !this.get(u)||AA;},_validateIconClose:function(AA){return !this.get(u)||AA;},_setIcon:function(AA){return A.get(AA)||null;},_setNodeLabel:function(AA){return A.get(AA)||null;},_setIconsContainer:function(AA){return A.get(AA)||null;},_setIconExpanded:function(AA){return A.get(AA)||null;},_setIconAlwaysVisible:function(AA){return A.get(AA)||null;},_setIconClose:function(AA){return A.get(AA)||null;}});S.build(c.NAME,c,[f],{dynamic:false});A.AccordionItem=c;}());},"@VERSION@",{optional:["dd-constrain","dd-proxy","dd-drop"],requires:["event","anim-easing","widget","widget-stdmod","json-parse"]});
=======
YUI.add("gallery-accordion",function(A){(function(){var t=A.Lang,U=A.Node,Y=A.Anim,H=A.Easing,M="accordion",W=A.WidgetStdMod,r=document.compatMode=="BackCompat",S=r&&A.UA.ie>0,T=S?1:0,I=A.ClassNameManager.getClassName,V="yui3-accordion-item",e=I(M,"proxyel","visible"),g=I(M,"graggroup"),a="beforeItemAdd",d="itemAdded",D="beforeItemRemove",h="itemRemoved",C="beforeItemResized",o="itemResized",c="beforeItemExpand",f="beforeItemCollapse",J="itemExpanded",l="itemCollapsed",i="beforeItemReorder",Q="beforeEndItemReorder",R="itemReordered",j="default",N="animation",O="alwaysVisible",E="expanded",b="collapseOthersOnExpand",X="items",s="contentHeight",B="iconClose",F="iconAlwaysVisible",G="stretch",q="px",Z="contentBox",m="boundingBox",k="rendered",n="bodyContent",P="children",K="parentNode",p="node",L="data";A.Accordion=A.Base.create(M,A.Widget,[],{initializer:function(u){this._initEvents();this.after("render",A.bind(this._afterRender,this));},destructor:function(){var u,x,v,w;u=this.get(X);w=u.length;for(v=w-1;v>=0;v--){x=u[v];u.splice(v,1);this._removeItemHandles(x);x.destroy();}},_initEvents:function(){this.publish(a);this.publish(d);this.publish(D);this.publish(h);this.publish(C);this.publish(o);this.publish(c);this.publish(f);this.publish(J);this.publish(l);this.publish(i);this.publish(Q);this.publish(R);},_forCollapsing:{},_forExpanding:{},_animations:{},_itemsHandles:{},_removeItemHandles:function(w){var v,u;v=this._itemsHandles[w];for(u in v){if(v.hasOwnProperty(u)){u=v[u];u.detach();}}delete this._itemsHandles[w];},_getNodeOffsetHeight:function(w){var u,v;if(w instanceof U){if(w.hasMethod("getBoundingClientRect")){v=w.invoke("getBoundingClientRect");if(v){u=v.bottom-v.top;return u;}}else{u=w.get("offsetHeight");return A.Lang.isValue(u)?u:0;}}else{if(w){u=w.offsetHeight;return A.Lang.isValue(u)?u:0;}}return 0;},_setItemProperties:function(w,y,v){var u,x;u=w.get(O);x=w.get(E);if(y!=x){w.set(E,y,{internalCall:true});}if(v!==u){w.set(O,v,{internalCall:true});}},_setItemUI:function(v,w,u){v.markAsExpanded(w);v.markAsAlwaysVisible(u);},_afterRender:function(v){var u;u=this.get("resizeEvent");this._setUpResizing(u);this.after("resizeEventChange",A.bind(this._afterResizeEventChange,this));},_afterResizeEventChange:function(u){this._setUpResizing(u.newVal);},_onItemChosen:function(z,AA,u){var y,w,x,v;y={};v=this.get(b);w=z.get(O);x=z.get(E);if(u){this.removeItem(z);return;}else{if(AA){if(x){w=!w;x=w?true:x;this._setItemProperties(z,x,w);this._setItemUI(z,x,w);return;}else{this._forExpanding[z]={"item":z,alwaysVisible:true};if(v){y[z]={"item":z};this._storeItemsForCollapsing(y);}}}else{if(x){this._forCollapsing[z]={"item":z};}else{this._forExpanding[z]={"item":z,"alwaysVisible":w};if(v){y[z]={"item":z};this._storeItemsForCollapsing(y);}}}}this._processItems();},_adjustStretchItems:function(){var u=this.get(X),v;v=this._getHeightPerStretchItem();A.Array.each(u,function(AA,z,y){var w,AC,AB,AD,x;AD=AA.get(s);x=AA.get(E);if(AD.method===G&&x){AB=this._animations[AA];if(AB){AB.stop();}w=AA.getStdModNode(W.BODY);AC=this._getNodeOffsetHeight(w);if(v<AC){this._processCollapsing(AA,v);}else{if(v>AC){this._processExpanding(AA,v);}}}},this);return v;},_getHeightPerStretchItem:function(){var u,w,v=0;w=this.get(X);u=this.get(m).get("clientHeight");A.Array.each(w,function(AB,AA,z){var AC,y,AE,AD,x;AE=AB.getStdModNode(W.HEADER);AD=AB.get(s);x=this._getNodeOffsetHeight(AE);u-=x;AC=!AB.get(E);if(AC){u-=T;return;}if(AD.method===G){v++;}else{y=this._getItemContentHeight(AB);u-=y;}},this);if(v>0){u/=v;}if(u<0){u=0;}return u;},_getItemContentHeight:function(w){var y,v=0,u,x;y=w.get(s);if(y.method==="auto"){u=w.getStdModNode(W.BODY);x=u.get(P).item(0);v=x?this._getNodeOffsetHeight(x):0;}else{if(y.method==="fixed"){v=y.height;}else{v=this._getHeightPerStretchItem();}}return v;},_storeItemsForCollapsing:function(v){var u;v=v||{};u=this.get(X);A.Array.each(u,function(AA,z,y){var x,w;x=AA.get(E);w=AA.get(O);if(x&&!w&&!v[AA]){this._forCollapsing[AA]={"item":AA};}},this);},_expandItem:function(w,u){var v=w.get(O);this._processExpanding(w,u);this._setItemUI(w,true,v);},_processExpanding:function(AB,AA,u){var v,w,y,AC=false,z,x;x=AB.getStdModNode(W.BODY);this.fire(C,{"item":AB});if(x.get("clientHeight")<=T){AC=true;this.fire(c,{"item":AB});}if(!u&&this.get("useAnimation")){y=AB.get(N)||{};v=new Y({node:x,to:{"height":AA}});v.on("end",A.bind(this._onExpandComplete,this,AB,AC));z=this.get(N);v.set("duration",y.duration||z.duration);v.set("easing",y.easing||z.easing);w=this._animations[AB];if(w){w.stop();}AB.markAsExpanding(true);this._animations[AB]=v;v.run();}else{x.setStyle("height",AA+q);this.fire(o,{"item":AB});if(AC){this.fire(J,{"item":AB});}}},_onExpandComplete:function(u,v){delete this._animations[u];u.markAsExpanding(false);this.fire(o,{"item":u});if(v){this.fire(J,{"item":u});}},_collapseItem:function(u){this._processCollapsing(u,T);this._setItemUI(u,false,false);},_processCollapsing:function(AB,AA,u){var v,w,y,z,x,AC=(AA===T);x=AB.getStdModNode(W.BODY);this.fire(C,{"item":AB});if(AC){this.fire(f,{"item":AB});}if(!u&&this.get("useAnimation")){y=AB.get(N)||{};v=new Y({node:x,to:{"height":AA}});v.on("end",A.bind(this._onCollapseComplete,this,AB,AC));z=this.get(N);v.set("duration",y.duration||z.duration);v.set("easing",y.easing||z.easing);w=this._animations[AB];if(w){w.stop();}AB.markAsCollapsing(true);this._animations[AB]=v;v.run();}else{x.setStyle("height",AA+q);this.fire(o,{"item":AB});if(AC){this.fire(l,{"item":AB});}}},_onCollapseComplete:function(u,v){delete this._animations[u];u.markAsCollapsing(false);this.fire(o,{item:u});if(v){this.fire(l,{"item":u});}},_initItemDragDrop:function(v){var z,u,y,w,x;z=v.getStdModNode(W.HEADER);if(z.dd){return;}y=this.get(m);w=v.get(m);u=new A.DD.Drag({node:z,groups:[g]}).plug(A.Plugin.DDProxy,{moveOnEnd:false}).plug(A.Plugin.DDConstrained,{constrain2node:y});x=new A.DD.Drop({node:w,groups:[g]});u.on("drag:start",A.bind(this._onDragStart,this,u));u.on("drag:end",A.bind(this._onDragEnd,this,u));
u.after("drag:end",A.bind(this._afterDragEnd,this,u));u.on("drag:drophit",A.bind(this._onDropHit,this,u));},_onDragStart:function(u,x){var w,v;v=this.getItem(u.get(p).get(K));w=u.get("dragNode");w.addClass(e);w.set("innerHTML",v.get("label"));return this.fire(i,{"item":v});},_onDragEnd:function(u,x){var w,v;w=u.get("dragNode");w.removeClass(e);w.set("innerHTML","");v=this.getItem(u.get(p).get(K));return this.fire(Q,{"item":v});},_afterDragEnd:function(u,x){var v,w;w=u.get(L);if(w.drophit){v=this.getItem(u.get(p).get(K));u.set(L,{drophit:false});return this.fire(R,{"item":v});}return true;},_onDropHit:function(AD,z){var y,AC,v,AB,x,u,AA,w,AE;AE=this.getItem(AD.get(p).get(K));w=this.getItem(z.drop.get(p));if(w===AE){return false;}y=this.getItemIndex(AE);AC=this.getItemIndex(w);v=w.get(m);AB=AE.get(m);x=this.get(Z);u=false;AA=this.get(X);if(AC<y){u=true;}x.removeChild(AB);if(u){x.insertBefore(AB,v);AA.splice(y,1);AA.splice(AC,0,AE);}else{x.insertBefore(AB,v.next(V));AA.splice(AC+1,0,AE);AA.splice(y,1);}AD.set(L,{drophit:true});return true;},_processItems:function(){var w,v,x,z,u,AA,y;w=this._forCollapsing;v=this._forExpanding;this._setItemsProperties();for(y in w){if(w.hasOwnProperty(y)){x=w[y];this._collapseItem(x.item);}}z=this._adjustStretchItems();for(y in v){if(v.hasOwnProperty(y)){x=v[y];y=x.item;u=z;AA=y.get(s);if(AA.method!==G){u=this._getItemContentHeight(y);}this._expandItem(y,u);}}this._forCollapsing={};this._forExpanding={};},_setItemsProperties:function(){var w,v,u;w=this._forCollapsing;v=this._forExpanding;for(u in w){if(w.hasOwnProperty(u)){u=w[u];this._setItemProperties(u.item,false,false);}}for(u in v){if(v.hasOwnProperty(u)){u=v[u];this._setItemProperties(u.item,true,u.alwaysVisible);}}},_afterItemExpand:function(y){var w,x,v,u;if(y.internalCall){return;}w=y.newVal;x=y.currentTarget;v=x.get(O);u=this.get(b);if(w){this._forExpanding[x]={"item":x,"alwaysVisible":v};if(u){this._storeItemsForCollapsing();}}else{this._forCollapsing[x]={"item":x};}this._processItems();},_afterItemAlwaysVisible:function(x){var w,u,v;if(x.internalCall){return;}u=x.newVal;w=x.currentTarget;v=w.get(E);if(u){if(v){this._setItemProperties(w,true,true);this._setItemUI(w,true,true);return;}else{this._forExpanding[w]={"item":w,"alwaysVisible":true};this._storeItemsForCollapsing();}}else{if(v){this._setItemUI(w,true,false);return;}else{return;}}this._processItems();},_afterContentHeight:function(z){var x,v,u,y,w;x=z.currentTarget;this._adjustStretchItems();if(z.newVal.method!==G){w=x.get(E);v=this._getItemContentHeight(x);u=x.getStdModNode(W.BODY);y=this._getNodeOffsetHeight(u);if(v<y){this._processCollapsing(x,v,!w);}else{if(v>y){this._processExpanding(x,v,!w);}}}},_afterContentUpdate:function(AA){var x,v,u,z,w,AB,y;x=AA.currentTarget;AB=x.get("contentHeight").method==="auto";w=x.get(E);if(AB&&w&&AA.src!==A.Widget.UI_SRC){A.later(0,this,function(){v=this._getItemContentHeight(x);u=x.getStdModNode(W.BODY);z=this._getNodeOffsetHeight(u);if(v!==z){y=this._animations[x];if(y){y.stop();}this._adjustStretchItems();if(v<z){this._processCollapsing(x,v,!w);}else{if(v>z){this._processExpanding(x,v,!w);}}}});}},_setUpResizing:function(u){if(this._resizeEventHandle){this._resizeEventHandle.detach();}if(u===j){this._resizeEventHandle=A.on("windowresize",A.bind(this._adjustStretchItems,this));}else{this._resizeEventHandle=u.sourceObject.on(u.resizeEvent,A.bind(this._adjustStretchItems,this));}},renderUI:function(){var v,u;v=this.get("srcNode");u=v.queryAll("> ."+V);u.each(function(z,w,y){var x;if(!this.getItem(z)){x=new A.AccordionItem({srcNode:z,id:z.get("id")});this.addItem(x);}},this);},bindUI:function(){var u,v;u=this.get(Z);v=this.get("itemChosen");u.delegate(v,A.bind(this._onItemChosenEvent,this),".yui3-widget-hd");},_onItemChosenEvent:function(z){var AB,AA,w,x,v,y,u;AB=z.currentTarget;AA=AB.get(K);w=this.getItem(AA);x=w.get(F);v=w.get(B);y=(x===z.target);u=(v===z.target);this._onItemChosen(w,y,u);},addItem:function(AG,w){var AA,AE,y,z,u,AD,AC,AF,x,AB,v;AB=this.fire(a,{"item":AG});if(!AB){return false;}AD=this.get(X);AC=this.get(Z);x=AG.get(Z);if(!x.inDoc()){if(w){u=this.getItemIndex(w);if(u<0){return false;}AD.splice(u,0,AG);AC.insertBefore(x,w.get(m));}else{AD.push(AG);AC.insertBefore(x,null);}}else{v=AC.get(P);AB=v.some(function(AJ,AI,AH){if(AJ===x){AD.splice(AI,0,AG);return true;}else{return false;}},this);if(!AB){return false;}}y=AG.getStdModNode(W.BODY);z=AG.get(n);if(!y&&!z){AG.set(n,"");}if(!AG.get(k)){AG.render();}AA=AG.get(E);AE=AG.get(O);AA=AA||AE;if(AA){this._forExpanding[AG]={"item":AG,"alwaysVisible":AE};}else{this._forCollapsing[AG]={"item":AG};}this._processItems();if(this.get("reorderItems")){this._initItemDragDrop(AG);}AF=this._itemsHandles[AG];if(!AF){AF={};}AF={"expandedChange":AG.after("expandedChange",A.bind(this._afterItemExpand,this)),"alwaysVisibleChange":AG.after("alwaysVisibleChange",A.bind(this._afterItemAlwaysVisible,this)),"contentHeightChange":AG.after("contentHeightChange",A.bind(this._afterContentHeight,this)),"contentUpdate":AG.after("contentUpdate",A.bind(this._afterContentUpdate,this))};this._itemsHandles[AG]=AF;this.fire(d,{"item":AG});return true;},removeItem:function(v){var u,y,x=null,w;u=this.get(X);if(t.isNumber(v)){w=v;}else{if(v instanceof A.AccordionItem){w=this.getItemIndex(v);}else{return null;}}if(w>=0){this.fire(D,{item:v});x=u.splice(w,1)[0];this._removeItemHandles(x);y=x.get(m);y.remove();this._adjustStretchItems();this.fire(h,{item:v});}return x;},getItem:function(w){var u=this.get(X),v=null;if(t.isNumber(w)){v=u[w];return(v instanceof A.AccordionItem)?v:null;}else{if(w instanceof U){A.Array.some(u,function(AB,AA,y){var x,z;x=AB.get(Z);z=AB.get(m);if(x===w){v=AB;return true;}else{if(z===w){v=AB;return true;}else{return false;}}},this);}}return v;},getItemIndex:function(w){var v=-1,u;if(w instanceof A.AccordionItem){u=this.get(X);A.Array.some(u,function(z,y,x){if(z===w){v=y;return true;}else{return false;}},this);}return v;}},{NAME:M,ATTRS:{itemChosen:{value:"click",validator:t.isString},items:{value:[],readOnly:true,validator:t.isArray},resizeEvent:{value:j,validator:function(u){if(u===j){return true;
}else{if(t.isObject(u)){if(t.isValue(u.sourceObject)&&t.isValue(u.resizeEvent)){return true;}}}return false;}},useAnimation:{value:true,validator:t.isBoolean},animation:{value:{duration:1,easing:H.easeOutStrong},validator:function(u){return t.isObject(u)&&t.isNumber(u.duration)&&t.isFunction(u.easing);}},reorderItems:{value:false,validator:function(u){return t.isBoolean(u)&&!t.isUndefined(A.DD);}},collapseOthersOnExpand:{value:true,validator:t.isBoolean}}});}());(function(){var u=A.Lang,b=A.Node,P=A.JSON,c=A.WidgetStdMod,d="accordion-item",N=A.ClassNameManager.getClassName,D=N(d,"iconexpanded","expanding"),s=N(d,"iconexpanded","collapsing"),O=N(d,"icon"),K=N(d,"label"),o=N(d,"iconalwaysvisible"),f=N(d,"icons"),m=N(d,"iconexpanded"),j=N(d,"iconclose"),Q=N(d,"iconclose","hidden"),S=N(d,"iconexpanded","on"),L=N(d,"iconexpanded","off"),E=N(d,"iconalwaysvisible","on"),k=N(d,"iconalwaysvisible","off"),Y=N(d,"expanded"),V=N(d,"closable"),h=N(d,"alwaysvisible"),i=N(d,"contentheight"),l="title",C="strings",q="rendered",H="className",e="auto",J="stretch",W="fixed",T=".yui3-widget-hd",Z=".",n=".yui3-widget-hd "+Z,r="innerHTML",t="iconsContainer",g="icon",R="nodeLabel",G="iconAlwaysVisible",a="iconExpanded",B="iconClose",p="href",U="#",F="yuiConfig",I=/^(?:true|yes|1)$/,M=/^auto\s*/,v=/^stretch\s*/,X=/^fixed-\d+/;A.AccordionItem=A.Base.create(d,A.Widget,[A.WidgetStdMod],{_createHeader:function(){var AE,AC,AD,AA,AB,z,x,w,y;AB=this.get(g);z=this.get(R);x=this.get(a);w=this.get(G);y=this.get(B);AA=this.get(t);AD=this.get(C);AE=this.get("closable");AC=A.AccordionItem.TEMPLATES;if(!AB){AB=b.create(AC.icon);this.set(g,AB);}if(!z){z=b.create(AC.label);this.set(R,z);}else{if(!z.hasAttribute(p)){z.setAttribute(p,U);}}z.setContent(this.get("label"));if(!AA){AA=b.create(AC.iconsContainer);this.set(t,AA);}if(!w){w=b.create(AC.iconAlwaysVisible);w.setAttribute(l,AD.title_always_visible_off);this.set(G,w);}else{if(!w.hasAttribute(p)){w.setAttribute(p,U);}}if(!x){x=b.create(AC.iconExpanded);x.setAttribute(l,AD.title_iconexpanded_off);this.set(a,x);}else{if(!x.hasAttribute(p)){x.setAttribute(p,U);}}if(!y){y=b.create(AC.iconClose);y.setAttribute(l,AD.title_iconclose);this.set(B,y);}else{if(!y.hasAttribute(p)){y.setAttribute(p,U);}}if(AE){y.removeClass(Q);}else{y.addClass(Q);}this._addHeaderComponents();},_addHeaderComponents:function(){var AC,x,AB,y,AA,z,w;x=this.get(g);AB=this.get(R);AA=this.get(a);z=this.get(G);w=this.get(B);y=this.get(t);AC=this.getStdModNode(c.HEADER);if(!AC){AC=new b(document.createDocumentFragment());AC.appendChild(x);AC.appendChild(AB);AC.appendChild(y);y.appendChild(z);y.appendChild(AA);y.appendChild(w);this.setStdModContent(c.HEADER,AC,c.REPLACE);}else{if(!AC.contains(x)){if(AC.contains(AB)){AC.insertBefore(x,AB);}else{AC.appendChild(x);}}if(!AC.contains(AB)){AC.appendChild(AB);}if(!AC.contains(y)){AC.appendChild(y);}if(!y.contains(z)){y.appendChild(z);}if(!y.contains(AA)){y.appendChild(AA);}if(!y.contains(w)){y.appendChild(w);}}},_labelChanged:function(x){var w;if(this.get(q)){w=this.get(R);w.set(r,x.newVal);}},_closableChanged:function(x){var w;if(this.get(q)){w=this.get(B);if(x.newVal){w.removeClass(Q);}else{w.addClass(Q);}}},initializer:function(w){this.after("labelChange",A.bind(this._labelChanged,this));this.after("closableChange",A.bind(this._closableChanged,this));},destructor:function(){},renderUI:function(){this._createHeader();},bindUI:function(){var w=this.get("contentBox");w.delegate("click",A.bind(this._onLinkClick,this),T+" a");},_onLinkClick:function(w){w.preventDefault();},markAsAlwaysVisible:function(x){var y,w;y=this.get(G);w=this.get(C);if(x){if(!y.hasClass(E)){y.replaceClass(k,E);y.set(l,w.title_always_visible_on);return true;}}else{if(y.hasClass(E)){y.replaceClass(E,k);y.set(l,w.title_always_visible_off);return true;}}return false;},markAsExpanded:function(x){var w,y;y=this.get(a);w=this.get(C);if(x){if(!y.hasClass(S)){y.replaceClass(L,S);y.set(l,w.title_iconexpanded_on);return true;}}else{if(y.hasClass(S)){y.replaceClass(S,L);y.set(l,w.title_iconexpanded_off);return true;}}return false;},markAsExpanding:function(x){var w=this.get(a);if(x){if(!w.hasClass(D)){w.addClass(D);return true;}}else{if(w.hasClass(D)){w.removeClass(D);return true;}}return false;},markAsCollapsing:function(w){var x=this.get(a);if(w){if(!x.hasClass(s)){x.addClass(s);return true;}}else{if(x.hasClass(s)){x.removeClass(s);return true;}}return false;},resize:function(){this.fire("contentUpdate");},_extractFixedMethodValue:function(AA){var x,z,y,w=null;for(x=6,z=AA.length;x<z;x++){y=AA.charAt(x);y=parseInt(y,10);if(u.isNumber(y)){w=(w*10)+y;}else{break;}}return w;},_validateIcon:function(w){return !this.get(q)||w;},_validateNodeLabel:function(w){return !this.get(q)||w;},_validateIconsContainer:function(w){return !this.get(q)||w;},_validateIconExpanded:function(w){return !this.get(q)||w;},_validateIconAlwaysVisible:function(w){return !this.get(q)||w;},_validateIconClose:function(w){return !this.get(q)||w;},_setIcon:function(w){return A.get(w)||null;},_setNodeLabel:function(w){return A.get(w)||null;},_setIconsContainer:function(w){return A.get(w)||null;},_setIconExpanded:function(w){return A.get(w)||null;},_setIconAlwaysVisible:function(w){return A.get(w)||null;},_setIconClose:function(w){return A.get(w)||null;},_applyParser:function(w){var x;x=this.get("srcNode");if(x){this._parsedYUIConfig=x.getAttribute(F);if(this._parsedYUIConfig){this._parsedYUIConfig=P.parse(this._parsedYUIConfig);}}A.AccordionItem.superclass._applyParser.apply(this,arguments);delete this._parsedYUIConfig;}},{NAME:d,ATTRS:{icon:{value:null,validator:function(w){return this._validateIcon(w);},setter:function(w){return this._setIcon(w);}},label:{value:"&#160;",validator:u.isString},nodeLabel:{value:null,validator:function(w){return this._validateNodeLabel(w);},setter:function(w){return this._setNodeLabel(w);}},iconsContainer:{value:null,validator:function(w){return this._validateIconsContainer(w);},setter:function(w){return this._setIconsContainer(w);
}},iconExpanded:{value:null,validator:function(w){return this._validateIconExpanded(w);},setter:function(w){return this._setIconExpanded(w);}},iconAlwaysVisible:{value:null,validator:function(w){return this._validateIconAlwaysVisible(w);},setter:function(w){return this._setIconAlwaysVisible(w);}},iconClose:{value:null,validator:function(w){return this._validateIconClose(w);},setter:function(w){return this._setIconClose(w);}},expanded:{value:false,validator:u.isBoolean},contentHeight:{value:{method:e},validator:function(w){if(u.isObject(w)){if(w.method===e){return true;}else{if(w.method===J){return true;}else{if(w.method===W&&u.isNumber(w.height)&&w.height>=0){return true;}}}}return false;}},alwaysVisible:{value:false,validator:u.isBoolean},animation:{value:{},validator:u.isObject},strings:{value:{title_always_visible_off:"Click to set always visible on",title_always_visible_on:"Click to set always visible off",title_iconexpanded_off:"Click to expand",title_iconexpanded_on:"Click to collapse",title_iconclose:"Click to close"}},closable:{value:false,validator:u.isBoolean}},HTML_PARSER:{icon:n+O,label:function(z){var y,AA,x,w;x=this._parsedYUIConfig;if(x&&u.isValue(x.label)){return x.label;}w=z.getAttribute("data-label");if(w){return w;}AA=n+K;y=z.query(AA);return(y)?y.get(r):null;},nodeLabel:n+K,iconsContainer:n+f,iconAlwaysVisible:n+o,iconExpanded:n+m,iconClose:n+j,expanded:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.expanded)){return x.expanded;}w=y.getAttribute("data-expanded");if(w){return I.test(w);}return y.hasClass(Y);},alwaysVisible:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.alwaysVisible)){w=x.alwaysVisible;}else{w=y.getAttribute("data-alwaysvisible");if(w){w=I.test(w);}else{w=y.hasClass(h);}}if(w){this.set("expanded",true,{internalCall:true});}return w;},closable:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.closable)){return x.closable;}w=y.getAttribute("data-closable");if(w){return I.test(w);}return y.hasClass(V);},contentHeight:function(AC){var AA,AB,w=0,x,z,y;z=this._parsedYUIConfig;if(z&&z.contentHeight){return z.contentHeight;}y=AC.getAttribute("data-contentheight");if(M.test(y)){return{method:e};}else{if(v.test(y)){return{method:J};}else{if(X.test(y)){w=this._extractFixedMethodValue(y);return{method:W,height:w};}}}AB=AC.get(H);AA=i+"-";x=AB.indexOf(AA,0);if(x>=0){x+=AA.length;AB=AB.substring(x);if(M.test(AB)){return{method:e};}else{if(v.test(AB)){return{method:J};}else{if(X.test(AB)){w=this._extractFixedMethodValue(AB);return{method:W,height:w};}}}}return null;}},TEMPLATES:{icon:'<a class="'+O+'"></a>',label:'<a href="#" class="'+K+'"></a>',iconsContainer:'<div class="'+f+'"></div>',iconExpanded:['<a href="#" class="',m," ",L,'"></a>'].join(""),iconAlwaysVisible:['<a href="#" class="',o," ",k,'"></a>'].join(""),iconClose:['<a href="#" class="',j," ",Q,'"></a>'].join("")}});}());},"gallery-2010.04.02-17-26",{optional:["dd-constrain","dd-proxy","dd-drop"],requires:["event","anim-easing","widget","widget-stdmod","json-parse"]});
>>>>>>> upstream/master
=======
YUI.add("gallery-accordion",function(A){(function(){var u=A.Lang,V=A.Node,Z=A.Anim,H=A.Easing,N="accordion",X=A.WidgetStdMod,s=document.compatMode=="BackCompat",T=s&&A.UA.ie>0,U=T?1:0,J=A.ClassNameManager.getClassName,W="yui3-accordion-item",f=J(N,"proxyel","visible"),h=J(N,"graggroup"),b="beforeItemAdd",e="itemAdded",D="beforeItemRemove",i="itemRemoved",C="beforeItemResized",p="itemResized",d="beforeItemExpand",g="beforeItemCollapse",K="itemExpanded",m="itemCollapsed",j="beforeItemReorder",R="beforeEndItemReorder",S="itemReordered",k="default",O="animation",P="alwaysVisible",E="expanded",c="collapseOthersOnExpand",Y="items",t="contentHeight",B="iconClose",F="iconAlwaysVisible",G="stretch",r="px",a="contentBox",n="boundingBox",I="srcNode",l="rendered",o="bodyContent",Q="children",L="parentNode",q="node",M="data";A.Accordion=A.Base.create(N,A.Widget,[],{initializer:function(v){this._initEvents();this.after("render",A.bind(this._afterRender,this));},destructor:function(){var v,y,w,x;v=this.get(Y);x=v.length;for(w=x-1;w>=0;w--){y=v[w];v.splice(w,1);this._removeItemHandles(y);y.destroy();}},_initEvents:function(){this.publish(b);this.publish(e);this.publish(D);this.publish(i);this.publish(C);this.publish(p);this.publish(d);this.publish(g);this.publish(K);this.publish(m);this.publish(j);this.publish(R);this.publish(S);},_forCollapsing:{},_forExpanding:{},_animations:{},_itemsHandles:{},_removeItemHandles:function(x){var w,v;w=this._itemsHandles[x];for(v in w){if(w.hasOwnProperty(v)){v=w[v];v.detach();}}delete this._itemsHandles[x];},_getNodeOffsetHeight:function(x){var v,w;if(x instanceof V){if(x.hasMethod("getBoundingClientRect")){w=x.invoke("getBoundingClientRect");if(w){v=w.bottom-w.top;return v;}}else{v=x.get("offsetHeight");return A.Lang.isValue(v)?v:0;}}else{if(x){v=x.offsetHeight;return A.Lang.isValue(v)?v:0;}}return 0;},_setItemProperties:function(x,z,w){var v,y;v=x.get(P);y=x.get(E);if(z!=y){x.set(E,z,{internalCall:true});}if(w!==v){x.set(P,w,{internalCall:true});}},_setItemUI:function(w,x,v){w.markAsExpanded(x);w.markAsAlwaysVisible(v);},_afterRender:function(w){var v;v=this.get("resizeEvent");this._setUpResizing(v);this.after("resizeEventChange",A.bind(this._afterResizeEventChange,this));},_afterResizeEventChange:function(v){this._setUpResizing(v.newVal);},_onItemChosen:function(AA,AB,v){var z,x,y,w;z={};w=this.get(c);x=AA.get(P);y=AA.get(E);if(v){this.removeItem(AA);return;}else{if(AB){if(y){x=!x;y=x?true:y;this._setItemProperties(AA,y,x);this._setItemUI(AA,y,x);return;}else{this._forExpanding[AA]={"item":AA,alwaysVisible:true};if(w){z[AA]={"item":AA};this._storeItemsForCollapsing(z);}}}else{if(y){this._forCollapsing[AA]={"item":AA};}else{this._forExpanding[AA]={"item":AA,"alwaysVisible":x};if(w){z[AA]={"item":AA};this._storeItemsForCollapsing(z);}}}}this._processItems();},_adjustStretchItems:function(){var v=this.get(Y),w;w=this._getHeightPerStretchItem();A.Array.each(v,function(AB,AA,z){var x,AD,AC,AE,y;AE=AB.get(t);y=AB.get(E);if(AE.method===G&&y){AC=this._animations[AB];if(AC){AC.stop();}x=AB.getStdModNode(X.BODY);AD=this._getNodeOffsetHeight(x);if(w<AD){this._processCollapsing(AB,w);}else{if(w>AD){this._processExpanding(AB,w);}}}},this);return w;},_getHeightPerStretchItem:function(){var v,x,w=0;x=this.get(Y);v=this.get(n).get("clientHeight");A.Array.each(x,function(AC,AB,AA){var AD,z,AF,AE,y;AF=AC.getStdModNode(X.HEADER);AE=AC.get(t);y=this._getNodeOffsetHeight(AF);v-=y;AD=!AC.get(E);if(AD){v-=U;return;}if(AE.method===G){w++;}else{z=this._getItemContentHeight(AC);v-=z;}},this);if(w>0){v/=w;}if(v<0){v=0;}return v;},_getItemContentHeight:function(x){var z,w=0,v,y;z=x.get(t);if(z.method==="auto"){v=x.getStdModNode(X.BODY);y=v.get(Q).item(0);w=y?this._getNodeOffsetHeight(y):0;}else{if(z.method==="fixed"){w=z.height;}else{w=this._getHeightPerStretchItem();}}return w;},_storeItemsForCollapsing:function(w){var v;w=w||{};v=this.get(Y);A.Array.each(v,function(AB,AA,z){var y,x;y=AB.get(E);x=AB.get(P);if(y&&!x&&!w[AB]){this._forCollapsing[AB]={"item":AB};}},this);},_expandItem:function(x,v){var w=x.get(P);this._processExpanding(x,v);this._setItemUI(x,true,w);},_processExpanding:function(AC,AB,v){var w,x,z,AD=false,AA,y;y=AC.getStdModNode(X.BODY);this.fire(C,{"item":AC});if(y.get("clientHeight")<=U){AD=true;this.fire(d,{"item":AC});}if(!v&&this.get("useAnimation")){z=AC.get(O)||{};w=new Z({node:y,to:{"height":AB}});w.on("end",A.bind(this._onExpandComplete,this,AC,AD));AA=this.get(O);w.set("duration",z.duration||AA.duration);w.set("easing",z.easing||AA.easing);x=this._animations[AC];if(x){x.stop();}AC.markAsExpanding(true);this._animations[AC]=w;w.run();}else{y.setStyle("height",AB+r);this.fire(p,{"item":AC});if(AD){this.fire(K,{"item":AC});}}},_onExpandComplete:function(v,w){delete this._animations[v];v.markAsExpanding(false);this.fire(p,{"item":v});if(w){this.fire(K,{"item":v});}},_collapseItem:function(v){this._processCollapsing(v,U);this._setItemUI(v,false,false);},_processCollapsing:function(AC,AB,v){var w,x,z,AA,y,AD=(AB===U);y=AC.getStdModNode(X.BODY);this.fire(C,{"item":AC});if(AD){this.fire(g,{"item":AC});}if(!v&&this.get("useAnimation")){z=AC.get(O)||{};w=new Z({node:y,to:{"height":AB}});w.on("end",A.bind(this._onCollapseComplete,this,AC,AD));AA=this.get(O);w.set("duration",z.duration||AA.duration);w.set("easing",z.easing||AA.easing);x=this._animations[AC];if(x){x.stop();}AC.markAsCollapsing(true);this._animations[AC]=w;w.run();}else{y.setStyle("height",AB+r);this.fire(p,{"item":AC});if(AD){this.fire(m,{"item":AC});}}},_onCollapseComplete:function(v,w){delete this._animations[v];v.markAsCollapsing(false);this.fire(p,{item:v});if(w){this.fire(m,{"item":v});}},_initItemDragDrop:function(w){var AA,v,z,x,y;AA=w.getStdModNode(X.HEADER);if(AA.dd){return;}z=this.get(n);x=w.get(n);v=new A.DD.Drag({node:AA,groups:[h]}).plug(A.Plugin.DDProxy,{moveOnEnd:false}).plug(A.Plugin.DDConstrained,{constrain2node:z});y=new A.DD.Drop({node:x,groups:[h]});v.on("drag:start",A.bind(this._onDragStart,this,v));
v.on("drag:end",A.bind(this._onDragEnd,this,v));v.after("drag:end",A.bind(this._afterDragEnd,this,v));v.on("drag:drophit",A.bind(this._onDropHit,this,v));},_onDragStart:function(v,y){var x,w;w=this.getItem(v.get(q).get(L));x=v.get("dragNode");x.addClass(f);x.set("innerHTML",w.get("label"));return this.fire(j,{"item":w});},_onDragEnd:function(v,y){var x,w;x=v.get("dragNode");x.removeClass(f);x.set("innerHTML","");w=this.getItem(v.get(q).get(L));return this.fire(R,{"item":w});},_afterDragEnd:function(v,y){var w,x;x=v.get(M);if(x.drophit){w=this.getItem(v.get(q).get(L));v.set(M,{drophit:false});return this.fire(S,{"item":w});}return true;},_onDropHit:function(AE,AA){var z,AD,w,AC,y,v,AB,x,AF;AF=this.getItem(AE.get(q).get(L));x=this.getItem(AA.drop.get(q));if(x===AF){return false;}z=this.getItemIndex(AF);AD=this.getItemIndex(x);w=x.get(n);AC=AF.get(n);y=this.get(a);v=false;AB=this.get(Y);if(AD<z){v=true;}y.removeChild(AC);if(v){y.insertBefore(AC,w);AB.splice(z,1);AB.splice(AD,0,AF);}else{y.insertBefore(AC,w.next(W));AB.splice(AD+1,0,AF);AB.splice(z,1);}AE.set(M,{drophit:true});return true;},_processItems:function(){var x,w,y,AA,v,AB,z;x=this._forCollapsing;w=this._forExpanding;this._setItemsProperties();for(z in x){if(x.hasOwnProperty(z)){y=x[z];this._collapseItem(y.item);}}AA=this._adjustStretchItems();for(z in w){if(w.hasOwnProperty(z)){y=w[z];z=y.item;v=AA;AB=z.get(t);if(AB.method!==G){v=this._getItemContentHeight(z);}this._expandItem(z,v);}}this._forCollapsing={};this._forExpanding={};},_setItemsProperties:function(){var x,w,v;x=this._forCollapsing;w=this._forExpanding;for(v in x){if(x.hasOwnProperty(v)){v=x[v];this._setItemProperties(v.item,false,false);}}for(v in w){if(w.hasOwnProperty(v)){v=w[v];this._setItemProperties(v.item,true,v.alwaysVisible);}}},_afterItemExpand:function(z){var x,y,w,v;if(z.internalCall){return;}x=z.newVal;y=z.currentTarget;w=y.get(P);v=this.get(c);if(x){this._forExpanding[y]={"item":y,"alwaysVisible":w};if(v){this._storeItemsForCollapsing();}}else{this._forCollapsing[y]={"item":y};}this._processItems();},_afterItemAlwaysVisible:function(y){var x,v,w;if(y.internalCall){return;}v=y.newVal;x=y.currentTarget;w=x.get(E);if(v){if(w){this._setItemProperties(x,true,true);this._setItemUI(x,true,true);return;}else{this._forExpanding[x]={"item":x,"alwaysVisible":true};this._storeItemsForCollapsing();}}else{if(w){this._setItemUI(x,true,false);return;}else{return;}}this._processItems();},_afterContentHeight:function(AA){var y,w,v,z,x;y=AA.currentTarget;this._adjustStretchItems();if(AA.newVal.method!==G){x=y.get(E);w=this._getItemContentHeight(y);v=y.getStdModNode(X.BODY);z=this._getNodeOffsetHeight(v);if(w<z){this._processCollapsing(y,w,!x);}else{if(w>z){this._processExpanding(y,w,!x);}}}},_afterContentUpdate:function(AA){var x,v,z,w,AB,y;x=AA.currentTarget;AB=x.get("contentHeight").method==="auto";w=x.get(E);v=x.getStdModNode(X.BODY);z=this._getNodeOffsetHeight(v);if(AB&&w&&AA.src!==A.Widget.UI_SRC){A.later(0,this,function(){var AC=this._getItemContentHeight(x);if(AC!==z){y=this._animations[x];if(y){y.stop();}this._adjustStretchItems();if(AC<z){this._processCollapsing(x,AC,!w);}else{if(AC>z){this._processExpanding(x,AC,!w);}}}});}},_setUpResizing:function(v){if(this._resizeEventHandle){this._resizeEventHandle.detach();}if(v===k){this._resizeEventHandle=A.on("windowresize",A.bind(this._adjustStretchItems,this));}else{this._resizeEventHandle=v.sourceObject.on(v.resizeEvent,A.bind(this._adjustStretchItems,this));}},renderUI:function(){var y,x,w,v;y=this.get(I);w=this.get(a);v=y.get("id");w.set("id",v);x=y.queryAll("> ."+W);x.each(function(AC,z,AB){var AA;if(!this.getItem(AC)){AA=new A.AccordionItem({srcNode:AC,id:AC.get("id")});this.addItem(AA);}},this);},bindUI:function(){var v,w;v=this.get(a);w=this.get("itemChosen");v.delegate(w,A.bind(this._onItemChosenEvent,this),".yui3-widget-hd");},_onItemChosenEvent:function(AA){var AC,AB,x,y,w,z,v;AC=AA.currentTarget;AB=AC.get(L);x=this.getItem(AB);y=x.get(F);w=x.get(B);z=(y===AA.target);v=(w===AA.target);this._onItemChosen(x,z,v);},addItem:function(AH,x){var AB,AF,z,AA,v,AE,AD,AG,y,AC,w;AC=this.fire(b,{"item":AH});if(!AC){return false;}AE=this.get(Y);AD=this.get(a);y=AH.get(a);if(!y.inDoc()){if(x){v=this.getItemIndex(x);if(v<0){return false;}AE.splice(v,0,AH);AD.insertBefore(y,x.get(n));}else{AE.push(AH);AD.insertBefore(y,null);}}else{w=AD.get(Q);AC=w.some(function(AK,AJ,AI){if(AK===y){AE.splice(AJ,0,AH);return true;}else{return false;}},this);if(!AC){return false;}}z=AH.getStdModNode(X.BODY);AA=AH.get(o);if(!z&&!AA){AH.set(o,"");}if(!AH.get(l)){AH.render();}AB=AH.get(E);AF=AH.get(P);AB=AB||AF;if(AB){this._forExpanding[AH]={"item":AH,"alwaysVisible":AF};}else{this._forCollapsing[AH]={"item":AH};}this._processItems();if(this.get("reorderItems")){this._initItemDragDrop(AH);}AG=this._itemsHandles[AH];if(!AG){AG={};}AG={"expandedChange":AH.after("expandedChange",A.bind(this._afterItemExpand,this)),"alwaysVisibleChange":AH.after("alwaysVisibleChange",A.bind(this._afterItemAlwaysVisible,this)),"contentHeightChange":AH.after("contentHeightChange",A.bind(this._afterContentHeight,this)),"contentUpdate":AH.after("contentUpdate",A.bind(this._afterContentUpdate,this))};this._itemsHandles[AH]=AG;this.fire(e,{"item":AH});return true;},removeItem:function(w){var v,z,y=null,x;v=this.get(Y);if(u.isNumber(w)){x=w;}else{if(w instanceof A.AccordionItem){x=this.getItemIndex(w);}else{return null;}}if(x>=0){this.fire(D,{item:w});y=v.splice(x,1)[0];this._removeItemHandles(y);z=y.get(n);z.remove();this._adjustStretchItems();this.fire(i,{item:w});}return y;},getItem:function(x){var v=this.get(Y),w=null;if(u.isNumber(x)){w=v[x];return(w instanceof A.AccordionItem)?w:null;}else{if(x instanceof V){A.Array.some(v,function(AB,AA,z){var y=AB.get(a);if(y===x){w=AB;return true;}else{return false;}},this);}}return w;},getItemIndex:function(x){var w=-1,v;if(x instanceof A.AccordionItem){v=this.get(Y);A.Array.some(v,function(AA,z,y){if(AA===x){w=z;return true;}else{return false;
}},this);}return w;},_findStdModSection:function(v){return this.get(I).one("> ."+A.WidgetStdMod.SECTION_CLASS_NAMES[v]);},CONTENT_TEMPLATE:null},{NAME:N,ATTRS:{itemChosen:{value:"click",validator:u.isString},items:{value:[],readOnly:true,validator:u.isArray},resizeEvent:{value:k,validator:function(v){if(v===k){return true;}else{if(u.isObject(v)){if(u.isValue(v.sourceObject)&&u.isValue(v.resizeEvent)){return true;}}}return false;}},useAnimation:{value:true,validator:u.isBoolean},animation:{value:{duration:1,easing:H.easeOutStrong},validator:function(v){return u.isObject(v)&&u.isNumber(v.duration)&&u.isFunction(v.easing);}},reorderItems:{value:false,validator:function(v){return u.isBoolean(v)&&!u.isUndefined(A.DD);}},collapseOthersOnExpand:{value:true,validator:u.isBoolean}}});}());(function(){var u=A.Lang,b=A.Node,P=A.JSON,c=A.WidgetStdMod,d="accordion-item",N=A.ClassNameManager.getClassName,D=N(d,"iconexpanded","expanding"),s=N(d,"iconexpanded","collapsing"),O=N(d,"icon"),K=N(d,"label"),o=N(d,"iconalwaysvisible"),f=N(d,"icons"),m=N(d,"iconexpanded"),j=N(d,"iconclose"),Q=N(d,"iconclose","hidden"),S=N(d,"iconexpanded","on"),L=N(d,"iconexpanded","off"),E=N(d,"iconalwaysvisible","on"),k=N(d,"iconalwaysvisible","off"),Y=N(d,"expanded"),V=N(d,"closable"),h=N(d,"alwaysvisible"),i=N(d,"contentheight"),l="title",C="strings",q="rendered",H="className",e="auto",J="stretch",W="fixed",T=".yui3-widget-hd",Z=".",n=".yui3-widget-hd "+Z,r="innerHTML",t="iconsContainer",g="icon",R="nodeLabel",G="iconAlwaysVisible",a="iconExpanded",B="iconClose",p="href",U="#",F="yuiConfig",I=/^(?:true|yes|1)$/,M=/^auto\s*/,v=/^stretch\s*/,X=/^fixed-\d+/;A.AccordionItem=A.Base.create(d,A.Widget,[A.WidgetStdMod],{_createHeader:function(){var AE,AC,AD,AA,AB,z,x,w,y;AB=this.get(g);z=this.get(R);x=this.get(a);w=this.get(G);y=this.get(B);AA=this.get(t);AD=this.get(C);AE=this.get("closable");AC=A.AccordionItem.TEMPLATES;if(!AB){AB=b.create(AC.icon);this.set(g,AB);}if(!z){z=b.create(AC.label);this.set(R,z);}else{if(!z.hasAttribute(p)){z.setAttribute(p,U);}}z.setContent(this.get("label"));if(!AA){AA=b.create(AC.iconsContainer);this.set(t,AA);}if(!w){w=b.create(AC.iconAlwaysVisible);w.setAttribute(l,AD.title_always_visible_off);this.set(G,w);}else{if(!w.hasAttribute(p)){w.setAttribute(p,U);}}if(!x){x=b.create(AC.iconExpanded);x.setAttribute(l,AD.title_iconexpanded_off);this.set(a,x);}else{if(!x.hasAttribute(p)){x.setAttribute(p,U);}}if(!y){y=b.create(AC.iconClose);y.setAttribute(l,AD.title_iconclose);this.set(B,y);}else{if(!y.hasAttribute(p)){y.setAttribute(p,U);}}if(AE){y.removeClass(Q);}else{y.addClass(Q);}this._addHeaderComponents();},_addHeaderComponents:function(){var AC,x,AB,y,AA,z,w;x=this.get(g);AB=this.get(R);AA=this.get(a);z=this.get(G);w=this.get(B);y=this.get(t);AC=this.getStdModNode(c.HEADER);if(!AC){AC=new b(document.createDocumentFragment());AC.appendChild(x);AC.appendChild(AB);AC.appendChild(y);y.appendChild(z);y.appendChild(AA);y.appendChild(w);this.setStdModContent(c.HEADER,AC,c.REPLACE);}else{if(!AC.contains(x)){if(AC.contains(AB)){AC.insertBefore(x,AB);}else{AC.appendChild(x);}}if(!AC.contains(AB)){AC.appendChild(AB);}if(!AC.contains(y)){AC.appendChild(y);}if(!y.contains(z)){y.appendChild(z);}if(!y.contains(AA)){y.appendChild(AA);}if(!y.contains(w)){y.appendChild(w);}}},_labelChanged:function(x){var w;if(this.get(q)){w=this.get(R);w.set(r,x.newVal);}},_closableChanged:function(x){var w;if(this.get(q)){w=this.get(B);if(x.newVal){w.removeClass(Q);}else{w.addClass(Q);}}},initializer:function(w){this.after("labelChange",A.bind(this._labelChanged,this));this.after("closableChange",A.bind(this._closableChanged,this));},destructor:function(){},renderUI:function(){this._createHeader();},bindUI:function(){var w=this.get("contentBox");w.delegate("click",A.bind(this._onLinkClick,this),T+" a");},_onLinkClick:function(w){w.preventDefault();},markAsAlwaysVisible:function(x){var y,w;y=this.get(G);w=this.get(C);if(x){if(!y.hasClass(E)){y.replaceClass(k,E);y.set(l,w.title_always_visible_on);return true;}}else{if(y.hasClass(E)){y.replaceClass(E,k);y.set(l,w.title_always_visible_off);return true;}}return false;},markAsExpanded:function(x){var w,y;y=this.get(a);w=this.get(C);if(x){if(!y.hasClass(S)){y.replaceClass(L,S);y.set(l,w.title_iconexpanded_on);return true;}}else{if(y.hasClass(S)){y.replaceClass(S,L);y.set(l,w.title_iconexpanded_off);return true;}}return false;},markAsExpanding:function(x){var w=this.get(a);if(x){if(!w.hasClass(D)){w.addClass(D);return true;}}else{if(w.hasClass(D)){w.removeClass(D);return true;}}return false;},markAsCollapsing:function(w){var x=this.get(a);if(w){if(!x.hasClass(s)){x.addClass(s);return true;}}else{if(x.hasClass(s)){x.removeClass(s);return true;}}return false;},resize:function(){this.fire("contentUpdate");},_extractFixedMethodValue:function(AA){var x,z,y,w=null;for(x=6,z=AA.length;x<z;x++){y=AA.charAt(x);y=parseInt(y,10);if(u.isNumber(y)){w=(w*10)+y;}else{break;}}return w;},_validateIcon:function(w){return !this.get(q)||w;},_validateNodeLabel:function(w){return !this.get(q)||w;},_validateIconsContainer:function(w){return !this.get(q)||w;},_validateIconExpanded:function(w){return !this.get(q)||w;},_validateIconAlwaysVisible:function(w){return !this.get(q)||w;},_validateIconClose:function(w){return !this.get(q)||w;},_setIcon:function(w){return A.get(w)||null;},_setNodeLabel:function(w){return A.get(w)||null;},_setIconsContainer:function(w){return A.get(w)||null;},_setIconExpanded:function(w){return A.get(w)||null;},_setIconAlwaysVisible:function(w){return A.get(w)||null;},_setIconClose:function(w){return A.get(w)||null;},_applyParser:function(w){var x;x=this.get("srcNode");if(x){this._parsedYUIConfig=x.getAttribute(F);if(this._parsedYUIConfig){this._parsedYUIConfig=P.parse(this._parsedYUIConfig);}}A.AccordionItem.superclass._applyParser.apply(this,arguments);delete this._parsedYUIConfig;},_findStdModSection:function(w){return this.get("srcNode").one("> ."+A.WidgetStdMod.SECTION_CLASS_NAMES[w]);},CONTENT_TEMPLATE:null},{NAME:d,ATTRS:{icon:{value:null,validator:function(w){return this._validateIcon(w);
},setter:function(w){return this._setIcon(w);}},label:{value:"&#160;",validator:u.isString},nodeLabel:{value:null,validator:function(w){return this._validateNodeLabel(w);},setter:function(w){return this._setNodeLabel(w);}},iconsContainer:{value:null,validator:function(w){return this._validateIconsContainer(w);},setter:function(w){return this._setIconsContainer(w);}},iconExpanded:{value:null,validator:function(w){return this._validateIconExpanded(w);},setter:function(w){return this._setIconExpanded(w);}},iconAlwaysVisible:{value:null,validator:function(w){return this._validateIconAlwaysVisible(w);},setter:function(w){return this._setIconAlwaysVisible(w);}},iconClose:{value:null,validator:function(w){return this._validateIconClose(w);},setter:function(w){return this._setIconClose(w);}},expanded:{value:false,validator:u.isBoolean},contentHeight:{value:{method:e},validator:function(w){if(u.isObject(w)){if(w.method===e){return true;}else{if(w.method===J){return true;}else{if(w.method===W&&u.isNumber(w.height)&&w.height>=0){return true;}}}}return false;}},alwaysVisible:{value:false,validator:u.isBoolean},animation:{value:{},validator:u.isObject},strings:{value:{title_always_visible_off:"Click to set always visible on",title_always_visible_on:"Click to set always visible off",title_iconexpanded_off:"Click to expand",title_iconexpanded_on:"Click to collapse",title_iconclose:"Click to close"}},closable:{value:false,validator:u.isBoolean}},HTML_PARSER:{icon:n+O,label:function(z){var y,AA,x,w;x=this._parsedYUIConfig;if(x&&u.isValue(x.label)){return x.label;}w=z.getAttribute("data-label");if(w){return w;}AA=n+K;y=z.query(AA);return(y)?y.get(r):null;},nodeLabel:n+K,iconsContainer:n+f,iconAlwaysVisible:n+o,iconExpanded:n+m,iconClose:n+j,expanded:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.expanded)){return x.expanded;}w=y.getAttribute("data-expanded");if(w){return I.test(w);}return y.hasClass(Y);},alwaysVisible:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.alwaysVisible)){w=x.alwaysVisible;}else{w=y.getAttribute("data-alwaysvisible");if(w){w=I.test(w);}else{w=y.hasClass(h);}}if(w){this.set("expanded",true,{internalCall:true});}return w;},closable:function(y){var x,w;x=this._parsedYUIConfig;if(x&&u.isBoolean(x.closable)){return x.closable;}w=y.getAttribute("data-closable");if(w){return I.test(w);}return y.hasClass(V);},contentHeight:function(AC){var AA,AB,w=0,x,z,y;z=this._parsedYUIConfig;if(z&&z.contentHeight){return z.contentHeight;}y=AC.getAttribute("data-contentheight");if(M.test(y)){return{method:e};}else{if(v.test(y)){return{method:J};}else{if(X.test(y)){w=this._extractFixedMethodValue(y);return{method:W,height:w};}}}AB=AC.get(H);AA=i+"-";x=AB.indexOf(AA,0);if(x>=0){x+=AA.length;AB=AB.substring(x);if(M.test(AB)){return{method:e};}else{if(v.test(AB)){return{method:J};}else{if(X.test(AB)){w=this._extractFixedMethodValue(AB);return{method:W,height:w};}}}}return null;}},TEMPLATES:{icon:'<a class="'+O+'"></a>',label:'<a href="#" class="'+K+'"></a>',iconsContainer:'<div class="'+f+'"></div>',iconExpanded:['<a href="#" class="',m," ",L,'"></a>'].join(""),iconAlwaysVisible:['<a href="#" class="',o," ",k,'"></a>'].join(""),iconClose:['<a href="#" class="',j," ",Q,'"></a>'].join("")}});}());},"gallery-2010.04.08-12-35",{optional:["dd-constrain","dd-proxy","dd-drop"],requires:["event","anim-easing","widget","widget-stdmod","json-parse"]});
>>>>>>> upstream/master
